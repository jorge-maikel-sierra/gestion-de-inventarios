<%- include('../partials/header') %>

<div class="page-header">
  <div>
    <nav class="breadcrumb">
      <a href="/categories">CategorÃ­as</a>
      <span>â€º</span>
      <a href="/categories/<%= item.category_id %>"><%= item.category_name %></a>
      <span>â€º</span>
      <span><%= item.name %></span>
    </nav>
    <h1 class="page-title"><%= item.name %></h1>
    <p class="page-subtitle">CategorÃ­a: <strong><%= item.category_name %></strong></p>
  </div>
  <div class="btn-group">
    <a href="/items/<%= item.id %>/edit" class="btn btn-secondary">âœï¸ Editar</a>
  </div>
</div>

<!-- â”€â”€â”€â”€ DETALLE DEL ITEM â”€â”€â”€â”€ -->
<div class="detail-grid">
  <div class="detail-main card">
    <div class="card-body">
      <% if (item.description) { %>
        <div class="detail-section">
          <h3>DescripciÃ³n</h3>
          <p><%= item.description %></p>
        </div>
      <% } %>

      <div class="detail-stats">
        <div class="detail-stat">
          <span class="detail-stat-label">Precio</span>
          <span class="detail-stat-value price-big">$<%= parseFloat(item.price).toFixed(2) %></span>
        </div>
        <div class="detail-stat">
          <span class="detail-stat-label">Stock disponible</span>
          <span class="detail-stat-value">
            <span class="stock-badge-lg <%= item.quantity === 0 ? 'stock-empty' : item.quantity < 5 ? 'stock-low' : 'stock-ok' %>">
              <%= item.quantity %> unidad<%= item.quantity !== 1 ? 'es' : '' %>
            </span>
          </span>
        </div>
        <div class="detail-stat">
          <span class="detail-stat-label">CategorÃ­a</span>
          <span class="detail-stat-value">
            <a href="/categories/<%= item.category_id %>"><%= item.category_name %></a>
          </span>
        </div>
      </div>

      <div class="detail-dates">
        <small>Creado: <%= new Date(item.created_at).toLocaleDateString('es-MX', { year: 'numeric', month: 'long', day: 'numeric' }) %></small>
        <small>Actualizado: <%= new Date(item.updated_at).toLocaleDateString('es-MX', { year: 'numeric', month: 'long', day: 'numeric' }) %></small>
      </div>
    </div>
  </div>
</div>

<!-- â”€â”€â”€â”€ ZONA DE PELIGRO â”€â”€â”€â”€ -->
<div class="danger-zone">
  <h3>âš ï¸ Zona de Peligro</h3>
  <p>Eliminar este producto es permanente e irreversible.</p>
  <button class="btn btn-danger" onclick="document.getElementById('delete-modal-item').style.display='flex'">
    ğŸ—‘ï¸ Eliminar Producto
  </button>
</div>

<!-- â”€â”€â”€â”€ MODAL ELIMINAR â”€â”€â”€â”€ -->
<div id="delete-modal-item" class="modal-overlay" style="display:none;">
  <div class="modal">
    <h3>ğŸ—‘ï¸ Confirmar eliminaciÃ³n</h3>
    <p>EstÃ¡s a punto de eliminar el producto <strong>"<%= item.name %>"</strong>.</p>
    <p class="modal-warning">âš ï¸ Esta acciÃ³n no se puede deshacer. Requiere contraseÃ±a de administrador.</p>

    <form action="/items/<%= item.id %>?_method=DELETE" method="POST">
      <div class="form-group">
        <label class="form-label" for="delete-admin-pass">ContraseÃ±a de Administrador</label>
        <input
          type="password"
          id="delete-admin-pass"
          name="admin_password"
          class="form-control"
          placeholder="Ingresa la contraseÃ±a..."
          required
          autocomplete="off"
        />
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-outline" onclick="document.getElementById('delete-modal-item').style.display='none'">
          Cancelar
        </button>
        <button type="submit" class="btn btn-danger">Confirmar EliminaciÃ³n</button>
      </div>
    </form>
  </div>
</div>

<%- include('../partials/footer') %>
